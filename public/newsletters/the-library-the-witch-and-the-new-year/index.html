
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Library, The Witch, and The New Year | CYBORG_ Newsletter</title>
    <link rel="stylesheet" href="/static/css/styles.css">

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Roboto+Flex:opsz,wght@8..144,100..1000&display=swap" rel="stylesheet">
    <!-- /FONTS -->

    <meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/>

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Upgrade your humanity.">
    <meta name="twitter:description" content="An exploration of technology and systems and how they interact, dominate, or support our humanity.">
    <meta name="twitter:site" content="@NotDefinedTech">
    <meta name="twitter:image" content="https://cyborgnewsletter.com/static/social/cyborg-subscribe-gen.jpg">
    <meta name="twitter:creator" content="@NotDefinedTech">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Upgrade your humanity.">
    <meta property="og:description" content="An exploration of technology and systems and how they interact, dominate, or support our humanity.">
    <meta property="og:url" content="https://cyborgnewsletter.com/">
    <meta property="og:site_name" content="CYBORG_ Newsletter">
    <meta property="og:image" content="https://cyborgnewsletter.com/static/social/cyborg-subscribe-gen.jpg">
    <meta property="og:image:secure_url" content="https://cyborgnewsletter.com/static/social/cyborg-subscribe-gen.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    
    <link rel="icon" href="/static/images/brand/favicon/cyborg.ico" sizes="32x32">

    
    <link rel="alternate" type="application/rss+xml" title="CYBORG_ Newsletter" href="/newsletters/feed/">

    
</head>
<body class="article">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JGP9HHYEJ7"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JGP9HHYEJ7');
    </script>

    
        <nav id="header">
    <a href="/">
        <div class="brand">
            <img src="/static/images/brand/logo-light.svg" alt="CYBORG" style="width: 120px;">
        </div>
    </a>

    <input type="checkbox" id="nav-toggle" class="nav-toggle">
    <label for="nav-toggle" class="nav-toggle-button">
        <span></span>
    </label>
    <div class="menu">
        <div class="navigation">
            <ul>
                <li>
                    <a href="/newsletters/" class="">Newsletters</a>
                </li>
                <li>
                    <a href="/topics/">Topics</a>
                </li>
            </ul>
        </div>
        <div class="action">
            <ul>
                <li>
                    <button id="open-search" class="btn" title="Open Search">
                        <svg viewBox="0 0 101 105" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M59.5 0C82.4198 0 101 18.5802 101 41.5C101 64.4198 82.4198 83 59.5 83C51.489 83 44.0096 80.7276 37.667 76.7959L10.751 104.461L0 94L26.543 66.7188C21.1861 59.7286 18 50.9871 18 41.5C18 18.5802 36.5802 0 59.5 0ZM59.5 15C44.8645 15 33 26.8645 33 41.5C33 56.1355 44.8645 68 59.5 68C74.1355 68 86 56.1355 86 41.5C86 26.8645 74.1355 15 59.5 15Z" fill="currentColor"/>
                        </svg>
                    </button>
                </li>
                <li>
                    <a href="/subscribe/" class="btn btn-primary">Subscribe <span class="cta-arrow"></span></a>
                </li>
            </ul>
        </div>
    </div>
</nav>
    
    
    <main id="main">
        
<ul class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope
    itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="/"><span itemprop="name">Home</span></a>&nbsp;/&nbsp;
        <meta itemprop="position" content="1" />
    </li>
    
    <li itemprop="itemListElement" itemscope
    itemtype="https://schema.org/ListItem">
        
        <a itemprop="item" href="/newsletters/"><span itemprop="name">Newsletters</span></a>&nbsp;/&nbsp;
        
        <meta itemprop="position" content="2" />
    </li>
    
    The Library, The Witch, and The New Year
</ul>

<article class="article" itemscope itemtype="https://schema.org/Article">
    <meta itemprop="name" content="">
    
    <meta itemprop="datePublished" content="2025-12-30T01:37:26Z">
    <div itemprop="author" itemscope itemtype="https://schema.org/Person">
        <meta itemprop="name" content="Jess Brown">
    </div>


    <div class="grid-article">
        <header>

            <div itemprop="isPartOf" itemscope itemtype="https://schema.org/PublicationIssue" itemid="#issue">
                <div itemscope itemtype="https://schema.org/Periodical" itemid="#periodical">
                    <meta itemprop="name" content="CYBORG_ Newsletter">
                    <meta itemprop="id" href="https://cyborgnewsletter.com/#periodical">
                </div>
                <div itemprop="copyrightHolder" itemscope itemtype="https://schema.org/Organization">
                    <meta itemprop="name" content="Not Defined LLC">
                </div>
                <div itemprop="isPartOf" itemscope itemtype="https://schema.org/PublicationVolume">
                    <link itemprop="isPartOf" href="https://cyborgnewsletter.com/#periodical" />
                    <meta itemprop="volumeNumber" content="105">
                </div>
            </div>
            
            <div class="publish-date" style="text-align: right;">December 30, 2025</div>
            <h1 itemprop="headline">The Library, The Witch, and The New Year</h1>
        </header>
        
        <div id="article-body" class="article-content" itemprop="articleBody">
            <p>The best thing I did for myself for the past year was going to the library first thing on Saturday mornings to read and study. I wasn‚Äôt able to go every single week, but I spent more time in the library than I have in years and I filled up an entire notebook of quotes and thoughts‚Äîmany of which have surfaced here in CYBORG_. I see my library usage in three phases throughout my life, and this recent Saturday visit is phase 3: deep study and reflection, all about technology, humanity, monstrosity, and a few other topics that I‚Äôm afraid of or that worry me.</p>
<p>I still stand by my assertion that New Year Resolutions are designed to fail, which is why I hate them and <a href="/newsletters/pre-new-year/">intentionally start nothing new</a> before or after the days surrounding January 1. However, I do know that most people enjoy the ritual aspect of reflection and the culturally agreed upon &quot;restart&quot; for the year, so if it works for you, you have my support! Instead of outlining tips for productivity like I did last year, or prescribing some formula for habit creation, I think my practice of library mornings gave me some insights that might be more valuable.</p>
<p>But first, we <em>must</em> set the stage with an episode of <cite>Buffy The Vampire Slayer</cite> to help us work through this.</p>
<h2>Gingerbread (S3 E11)</h2>
<p>Buffy's mom, Joyce, stumbles upon two &quot;dead&quot; children in a park while trying to support Buffy on one nightly patrol. A mysterious symbol was drawn on the hands of the two children making it appear to be a ritual murder, rather than the typical monster rampage that is common in Sunnydale. Deeply disturbed, Joyce becomes more and more involved with the murders, eventually setting up a town vigil and founding MOO (Mothers Opposed to the Occult) to take community action against &quot;the monsters and the witches and the slayers.&quot;</p>
<p>Now, if you're not familiar with <cite>Buffy The Vampire Slayer</cite> (might I suggest that is a <em>great</em> New Year Resolution ;) ;) ;) ), then here is the basic plot of the majority of episodes:</p>
<ol>
<li>An ominous presence or something monstrous threatens someone (or everyone)</li>
<li>One of the main characters has an initial encounter with the monster or antagonist</li>
<li>Research is initiated, usually at the library</li>
<li>The conflict continues</li>
<li>Research finally yields the key information needed</li>
<li>Buffy either gets the research finding in time or somehow figures it out on her own and saves the day</li>
</ol>
<p>Going to the library to search for answers within ‚Äúmusty books‚Äù is so common, I don‚Äôt actually recall an episode where some form of research doesn't happen. Granted, sometimes they use computers, sometimes it‚Äôs maps and other materials, sometimes the library has been blown up or takes the form of personal collections, but research mode is a major theme throughout the series. In this particular episode, the books themselves become labelled a threat and Joyce orders them to be confiscated, which stalls the progress of Mr. Giles (the librarian and Buffy‚Äôs Watcher / mentor) and team (Buffy‚Äôs friends) from getting to the bottom of the murdered children.</p>
<p><q>...they took all of Giles' books away,</q> Buffy protests to her mother after the raid on the school library.</p>
<p><q>He'll get most of them back,</q> Joyce responds calmly. <q>MOO just wants to weed out the offensive material.</q></p>
<p><q>If we're going to solve this, we need those books now,</q> Buffy rebuts.</p>
<p><q>Sweetie, those books have no place in a public school library. Especially now. Any student can waltz in there and get all sorts of ideas. Do you understand how that terrifies me?</q></p>
<p>Frustrated, Buffy leaves for patrol and winds up with an epiphany: no one has claimed these kids as theirs, no one has talked about where they went to school, not even their names are known. She immediately takes this to the research crew at the library.</p>
<p><q>We know everything about their deaths, but we don't even know their names...And if no one knows who they are, where did these pictures come from?</q> Buffy asks.</p>
<p><q>I just assumed someone had the details. I never really...Well, that is strange,</q> Giles concedes.</p>
<p>As the team researches, the same pair of kids turn up &quot;dead&quot; every 50 years until the 17·µó ∞ century, suggesting a demon rather than actual murder. Just after this discovery, they find out that a classmate, Amy, who's known for practicing witchcraft has been taken from her home (and soon Buffy's friend, Willow, will also be taken by the mob) to the City Hall. It's clear that violence is erupting among the terrified adults and when Buffy goes to her mom to try and defuse the situation, Joyce turns on her, knocking Buffy out with chloroform.</p>
<p>Joyce and the other parents have been under the thrall of the demon responsible for the panic and the mirage of the murdered children. It has been making frequent appearances in the form of the two children themselves‚Äîthey appear in Buffy's house and talk to Joyce when Buffy isn't around.</p>
<p>The three teenage girls, Buffy, Amy and Willow, are tied to stakes inside the City Hall, books scattered across the floor at their feet. The mob of MOO gathered to behold them, torches in hands. Buffy's mom and Willow's mom both help light the books on fire, fully convinced by the demon in children form that their own children must be sacrificed.</p>
<figure>
    <img src="https://embed.filekitcdn.com/e/iDKTPNXrEJsYXUT7GCu1J3/6Aoew4zdyNztUACec3xoC6/email" alt="">
    <figcaption>Buffy and Willow tied to stakes inside the building, surrounded by burning books and watched by the mob.
    </figcaption>
</figure>
<p>Never fear, the demon is revealed and Buffy takes it out, but the aftermath is interesting. Willow remarks that her mom is <q>doing that selective memory thing that [Buffy's] mom used to be so good at.</q></p>
<p>This entire episode is hitting home to me on many fronts, given the political turmoil in the U.S., the connection to the Salem Witch Trials, book banning, and movements that take part in the harm they are supposedly trying to oppose.</p>
<h2>What is a Library?</h2>
<p>In phase 1 of my library experience, my mom used to take me there regularly as a kid. It was a place where I could wander, literally, through knowledge, history, and inspiration. I had a few go-to sections: art books, PC games, and the Boy Scouts of America merit badge pamphlet rack, but I also encountered new ideas and themes like old Universal monster movies, novels about Merlin, DIY woodworking projects, World War II accounts, Japanese language-learning books, and even the racist, vitriolic writings of Ann Coulter (which I spent way too much time ingesting as a teenager in search of identity and belonging).</p>
<p>Later, in phase 2, as I struggled with constant thoughts of suicide, I found an LGBTQ support group that met at my new local library. I was deeply afraid of meeting other queer people, but I also knew I had to do something different, because what I was doing kept pushing me to the brink of despair. It was the first time I realized I wasn't alone. This group was full of college kids, so I just hung back as the &quot;old&quot; 28-year-old and watched presentations or listened to panels of people with various queer identities. This group carved out space and time for healing and connection.</p>
<p>Libraries are more than &quot;musty books&quot; (and books are more powerful than they might seem), they're a space where anyone can explore the world. Anyone can walk in and encounter an idea that never occurred to them before. I've found competing ideas, beliefs, and values in books all housed by the same library, much like you'll find those same things in the people that visit that one place. To think that a library could offer me the dehumanizing rhetoric of Ann Coulter just the same as the validating stories of <cite>Hijab Butch Blues</cite> or <cite>Boy Erased</cite> or even just finding queer people from my own faith tradition grappling with the same wounds, questions, and hope is astounding!</p>
<p><q>[Anyone] can waltz in there and get all sorts of ideas. Do you understand how that terrifies me?</q></p>
<p>Yes, Joyce, I can understand how that terrifies you and everyone else, because it has terrified me too. That's the trick of living in this world: how to grapple with beliefs, ideas, and values that contradict each other. The one thing that I know most of all is that taking away the choices, the books, the ideas that you don't like is the worst solution to that fear.</p>
<p>Even just from an anecdotal and very personal experience as a queer kid growing up without access to language about my experience, I can tell you that's the most dangerous way to go about controlling content and information. I've spent more of my life wishing I were dead than I have with any other thoughts, desires, or personal narratives. Granted my lack of access was largely self-inflicted because of my faith tradition's constant conditioning to avoid any material that might put dangerous ideas in your head (and I took that to heart). However, the effect was the same.</p>
<p>The minute I walked through those library doors and into that room, I finally had access to the vocabulary, the science, the knowledge that could shatter my path to self-destruction. Sheltering me from &quot;gay stuff&quot; as a kid did not help me. Sheltering myself with a dogmatic insistence to not look at any source considered &quot;not Church approved&quot; perpetuated my psychological suffering.</p>
<p>What is a library? It's where we go to engage with the world and to take hold of life in a way that empowers us. It's an agency-portal where we choose what to encounter, what to dismiss, and what to wrestle with.</p>
<h2>Joyce to the World</h2>
<p>With eerie coincidence, <a href="https://www.youtube.com/watch?v=gf0xhf0GYc0">an interview with Dr. Joseph Laycock</a> happened to be released this weekend, that discusses almost all of the themes we see play out in the Gingerbread episode of <em>Buffy</em>: Everything from toxic groups (cults, political ideologies, and other dangerous or nefarious groups) to justifications for persecuting those groups to even intentional forgetting (like Willow described about her mom selectively remembering only parts of what happened).</p>
<p>Despite <cite>Buffy</cite> being mainly a comedy show, it very well captures real-world, repeating events. People have possibly always used fear tactics like claiming some group is doing horrendous things to children (eating them, burning them, drinking their blood, etc.) as well as other &quot;weird&quot; behavior (usually sexual) just to motivate and garner supporters for their group.</p>
<p>As Laycock suggests in the interview, it's really a power grab at the expense of a minority group. He gives the example of the <a href="https://www.britannica.com/topic/Bacchanalia">Bacchanalia</a> in ancient Rome. There was a motion to sanction &quot;religion&quot; and have more control over rituals and groups, so they needed to centralize more power in the Senate. The solution? Take those weirdos that we already have known about for a while and make them sound way worse than they are, so that it seems reasonable to go with the power consolidation‚Äîbecause <em>they</em> aren't the ones hurting children, performing evil rituals, and doing all manner of lascivious acts.</p>
<p>It's a 21st century trick, too. Maybe you've heard racist rumors about Haitian Americans eating neighbors' pets? That Hillary Clinton eats babies? Or any number of idiotic, yet believed conspiracy theories. I'm being harsh because it's deeply upsetting to me to see blatant demonization of people, and yet, as Laycock warns, there is a risk of actually participating in the exact same behavior (or at least perpetuating harm) in the pursuit of persuading people to my way of thinking.</p>
<p>Just like Joyce, who was trying to help in a deeply disturbing situation but ended up wielding the same callousness against her own child as the imagined occultists would have used to ritually murder the two kids. What this episode and this interview with Laycock have helped me see is how uncomfortable we humans can be with discomfort‚Äîand the knee-jerk reaction is to try and control other people so that we can feel more comfortable.</p>
<p>Taking away books didn't help people get to the bottom of the murders, but it did make Joyce feel better. Organizing a group of vigilantes didn't make Sunnydale a safer town, but it made that group feel like they were in control.</p>
<p>Giles helps us understand the &quot;demon&quot; that was influencing the townspeople:</p>
<p><q>Some demons thrive by fostering hatred and persecution amongst the mortal animals. Not by destroying men, but by watching men destroy each other. They feed us our darkest fears, turn peaceful communities into vigilantes,</q> Giles explains.</p>
<p><q>>Hansel and Gretel run home to tell everyone about the mean old witch,</q> Buffy summarizes.</p>
<p><q>And then she and probably dozens of others are persecuted by a righteous mob. It's happened all throughout history. It happened in Salem, not surprisingly.</q></p>
<p>The only difference is that in real life, there are no demons. There's just us. The most poignant part of Laycock's interview is the idea that there is not really any kind of mind control. There is plenty of behavior control, but so-called cults, religions, and other groups don't really have a magical grip on your mind. Excepting some cases of mental illness, perhaps, what we lay-people call &quot;mind control&quot; or &quot;brainwashing&quot; is really just a form of justification for explaining why people do, say, or think things that we don't like. It's much easier to say that a demon possessed someone or that a toxic group has brainwashed our loved one rather than to accept that the person may actually genuinely believe in their beliefs. Even easier to blame an outside influence for our own choices when we realize what we've done or believed was wrong.</p>
<figure>
<blockquote>
<p>...the Salem witch trials, for example, did not last very long at all‚Äîa little bit over a year‚Äîand afterwards there was a realization by this Puritan community that <em>we made a mistake</em>. And they said things like, &quot;it felt at the time as if we were walking through clouds,&quot; which I think is very telling. So we have these purges, these moments where we get very excited about some group that we perceive as a threat. We often do terrible things to combat the challenge and then...very often we sort of forget that it ever happened, which is deeply disturbing. And I think this is why it's very important that historians pay attention to things like the satanic panic and witch hunting and so forth so that we can better understand the moment that we're in right now.
</p>
</blockquote>
<figcaption>‚ÄîDr. Joseph Laycock, <a href="https://youtu.be/gf0xhf0GYc0?si=tlmY5UNT83DI1z7f&amp;t=1117">18:37</a></figcaption>
</figure>
<h2>Cyborg</h2>
<p>Libraries are the OG Internet, but I feel like I get better, cleaner dopamine hits when I'm exploring the stacks than when I'm scrolling on a browser. There's also almost no chance of running into AI-generated slop, which is a huge plus. But it's more than just a place to read and study. It's a sacred place, to me, because of its generosity. People of all kinds can enter, connect, express ideas, encounter ideas, and consider new possibilities.</p>
<p>I have found many beautiful things in libraries throughout my life. I have found many disdainful, hurtful, and untrue things there as well, but I'm better off having encountered <em>all of it</em> and having practiced how to deal with the things I don't like or don't believe.</p>
<p>When we read (or listen to someone), we have the chance to practice empathy by trying to understand. Chris Voss, ex-FBI hostage negotiator, has said that empathy isn't about <em>agreement</em>. We don't have to agree with everything we read or everything we hear. Empathy, I believe, can help us resist the temptation to demonize others and attempt to control them and their access to information.</p>
<p>If anything, I think it's our duty to go offline and get into local spaces like libraries so that we can engage with people in safer spaces. No one ever changed their mind after a fiery comment thread on social media, but people <em>do</em> change their minds when they get better information and have the safety of real social connections to guide them through transitions of thoughts and beliefs.</p>
<p>While I'm not prescribing going to the library as a resolution for this upcoming year, I do hope the principles we've discussed can help us with the challenges that 2026 has for us.</p>
<h2>Actions and Other Resources</h2>
<p>(U.S. links)</p>
<ul>
<li><a href="https://5calls.org/issue/kids-online-safety-act-kosa/">Oppose the KOSA act</a>, which almost sounds like the same old &quot;protect the children&quot; plot we just finished talking about...</li>
<li><a href="https://5calls.org/issue/constituent-services-concerned-voter/">Voice your support</a> for government funding of library, museum, and other public education resources like PBS.</li>
</ul>
<p>Books about &quot;cults&quot; and how people change</p>
<ul>
<li><a href="https://www.penguinrandomhouse.com/books/706443/the-quiet-damage-by-jesselyn-cook/"><cite>The Quiet Damage</cite></a>, by Jesselyn Cook. Excellent look at how QAnon affects relationships and the dangers of conspiratorial thinking</li>
<li><a href="https://www.penguinrandomhouse.com/books/771266/the-penguin-book-of-cults-by-edited-by-joseph-p-laycock/"><cite>The Penguin Book of Cults</cite></a>, by Joseph Laycock (I haven't read this yet, but after the interview I saw, it's on my list)</li>
<li><a href="https://www.goodreads.com/book/show/57933312-how-minds-change"><cite>How Minds Change</cite></a>, David McRaney. The most hopeful book I read this year</li>
</ul>
        </div>

        <div class="rail">
            <aside id="article-outline">
                <h2>Outline</h2>
                <nav aria-label="Outline">
                    <ul id="article-outline-content"></ul>
                </nav>
                <script>
                const outline = document.getElementById('article-outline-content');
                const content = document.querySelector('.article-content');
                
                function generateOutline(contentElement) {
                const headings = contentElement.querySelectorAll('h1, h2, h3, h4, h5, h6');
                if(headings.length > 0){
                        headings.forEach(heading => {
                            const outlineItem = document.createElement('li');
                            const anchor = document.createElement('a');
                            anchor.href = '#' + heading.id; // If headings have IDs
                            anchor.textContent = heading.textContent;
                            outlineItem.appendChild(anchor);
                            outlineItem.classList.add(heading.tagName.toLowerCase()); 
            
                            anchor.addEventListener('click', (event) => {
                                event.preventDefault();
                                heading.scrollIntoView({ behavior: 'smooth' });
                            });
            
                            outline.appendChild(outlineItem);
                        });
                    }
                    else {
                        const article = document.getElementById("blog-article");
                        const sidebar = document.getElementById("outline-sidebar");
                        article.classList.remove("justify-content-between");
                        article.classList.add("justify-content-center");
                        sidebar.classList.add("d-none");
                    }
                }
                generateOutline(content);
                </script>
            </aside>

            
            
            <aside id="glossary">
                <h2>Glossary</h2>
                <nav aria-label="Outline">
                    <ul id="article-glossary-content">
                    
                        
                        
                        <li><a href="/glossary/agency/">Agency&nbsp;&rsaquo;</a></li>
                        
                    
                        
                        
                        <li><a href="/glossary/religion/">Religion&nbsp;&rsaquo;</a></li>
                        
                    
                    </ul>
                </nav>
            </aside>
            
        </div>
    </div>
</article>

<div class="linked-articles">
    
    <div id="pre-new-year" class="link-preview" popover>
        <a href="/newsletters/pre-new-year/">
            <div class="card">
                <div class="card-body">
                    <h2>Pre-New Year</h2>
                    <div>Three personal knowledge management tips that can set a foundation for next year&#x27;s goals and needs.</div>
                    <div class="date"><small>December 17, 2024</small></div>
                </div>
            </div>
        </a>
    </div>
    
</div>

<div class="linked-terms">
    
</div>




    </main>
    
    
    <footer>
        <div class="row">
            <div class="copyright">
                &copy; 2026 Not Defined LLC. All rights reserved.
            </div>
            <div class="policies">
                <a href="/policies/artificial-intelligence/">AI Policy</a>
            </div>
        </div>
        <div class="row">
            <div class="attribution">
                Designed, developed, and written with üåà by Jess Brown.
            </div>
        </div>
    </footer>
    

    
    
    <dialog id="search-modal">
            <div class="modal-header">
                <h2>Search</h2>
                <form method="dialog">
                    <button class="btn btn-close" title="Close">&times;</button>
                </form>
            </div>
            
            <input type="search" id="search-input" placeholder="What are you looking for?" autocomplete="off">
            <div class="modal-body">
                <div id="docfind-results"></div>
            </div>
    </dialog>
    <script defer>
        const searchModal = document.getElementById('search-modal');
        const openBtn = document.getElementById('open-search');
        const searchInput = document.getElementById('search-input');

        // Open modal
        openBtn.addEventListener('click', () => {
            searchModal.showModal();
            // Auto-focus the input when it opens
            searchInput.focus();
        });

        // Optional: Close modal if user clicks outside the content box (on the backdrop)
        searchModal.addEventListener('click', (e) => {
            if (e.target === searchModal) searchModal.close();
        });
    </script>
    

    


    <script src="/static/js/scripts.js" defer></script>

    
    <script type="module">
    import search from '/static/search/docfind.js';

    const input = document.getElementById('search-input');
    const resultsDiv = document.getElementById('docfind-results');

    function escapeHTML(str) {
        if (!str) return "";
        return str.replace(/[&<>"']/g, function(m) {
            return {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#39;'
            }[m];
        });
    }

    function debounce(func, timeout = 300) {
        let timer;
        return (...args) => {
            clearTimeout(timer);
            timer = setTimeout(() => { func.apply(this, args); }, timeout);
        };
    }

    async function performSearch(query) {
        if (query.length < 2) {
            resultsDiv.innerHTML = '';
            return;
        }

        resultsDiv.innerHTML = '<p>Searching...</p>';

        // The 'search' function returns an array of matching documents
        const results = await search(query);

        if (results.length === 0) {
            resultsDiv.innerHTML = `
                <div class="no-results">
                    <p>No newsletters found matching "<strong>${escapeHTML(query)}</strong>".</p>
                </div>
            `;
            return;
        }
        
        resultsDiv.innerHTML = results.map(res => {
            const safeTitle = escapeHTML(res.title);
            const safeHref = encodeURI(res.href);
            
            // 1. Extract the tags from the body string
            // We split by the "Tags:" prefix you added in Django
            let displayBody = res.body || "";
            let tags = [];
            
            if (displayBody.includes("Tags: ")) {
                const parts = displayBody.split("Tags: ");
                displayBody = parts[0]; // Everything before "Tags:"
                tags = parts[1].split(", "); // Everything after "Tags:", split into an array
            }

            const safeBody = escapeHTML(displayBody.substring(0, 150));

            // 2. Build the Tags HTML
            const tagsHTML = tags.length > 0 
                ? `<div class="result-tags">
                    ${tags.map(tag => `<span class="chip">${escapeHTML(tag)}</span>`).join('')}
                </div>`
                : '';

            return `
                <div class="search-result">
                    <a href="${safeHref}">
                        <h3>${safeTitle}</h3>
                    </a>
                    <p>${safeBody}...</p>
                    ${tagsHTML}
                </div>
            `;
        }).join('');
    }

    const processChange = debounce((e) => performSearch(e.target.value));
    input.addEventListener('input', processChange);
</script>

    
<script defer>
document.addEventListener('DOMContentLoaded', () => {
    const article = document.getElementById("article-body");
    const newsletterLinks = article.querySelectorAll('a[href^="/newsletters/"]');

    newsletterLinks.forEach(link => {
        link.classList.add("link-with-preview");
        // Get slug
        const url = link.getAttribute('href');
        const slugMatch = url.match(/\/newsletters\/([^/]+)\/$/);
        if (slugMatch && slugMatch[1]) {
            link.setAttribute('data-popover-target', slugMatch[1])
        }
    });
    
    // Must search within article body only, since there are glossaryLinks in the aside, now.
    const glossaryLinks = article.querySelectorAll('a[href^="/glossary/"]');

    glossaryLinks.forEach(link => {
        link.classList.add("link-with-preview");
        const termUrl = link.getAttribute('href');
        const termSlugMatch = termUrl.match(/\/(glossary)\/([^/]+)\/$/);
        if (termSlugMatch && termSlugMatch[1]) {
            link.setAttribute('data-popover-target', (termSlugMatch[1] + '-' + termSlugMatch[2]))
        }
    });



  const links = document.querySelectorAll('.link-with-preview');

  links.forEach(link => {
    const popoverId = link.getAttribute('data-popover-target');
    const popover = document.getElementById(popoverId);
    const popoverAnchor = '--' + popoverId;

    // Have to override the anchor-name/position-anchor so that each link uniquely positions the preview (otherwise it all goes to the last one)
    link.style.anchorName = popoverAnchor;
    popover.style.positionAnchor = popoverAnchor;

    if (popover) {
      link.addEventListener('mouseenter', () => {
        popover.showPopover();
      });

      link.addEventListener('mouseleave', () => {
        popover.hidePopover();
      });
    }
  });
});
</script>


</body>
</html>